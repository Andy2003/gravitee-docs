= Active Directory / LDAP
:page-sidebar: am_3_x_sidebar
:page-permalink: am/current/am_userguide_enterprise_identity_provider_ldap.html
:page-folder: am/user-guide
:page-layout: am

Gravitee.io AM allows you to authenticate users with your entreprise Active Director or LDAP server.

== Create an Active Directory / LDAP identity provider

Identity providers are created for each security domain, to create an identity provider, follow these steps:

. Go to http://GRAVITEEIO-AM-UI-HOST
. From the homepage, go to your security domain's `Settings` page, go to `Providers` section
. From the security domain's providers page, click `(+)` button
. Choose the `LDAP` identity provider and press `NEXT`
. Give your identity provider a name
. Configure the settings as requested
. Press `Create`

You can also create the identity provider via the Gravitee.io AM API

[source]
----
curl -H "Authorization: Bearer :accessToken" \
     -H "Content-Type:application/json;charset=UTF-8" \
     -X POST \
     -d '{
           "type": "ldap-am-idp",
           "name": "LDAP IdP",
           "configuration": "{\"contextSourceUrl\":\"ldap://myserver.example.com:389\",\"contextSourceBase\":\"baseDN\",\"contextSourceUsername\":\"username\",\"contextSourcePassword\":\"password\",\"userSearchFilter\":\"uid={0}\",\"userSearchBase\":\"ou=users\",\"groupSearchBase\":\"ou=applications\",\"groupSearchFilter\":\"(uniqueMember={0})\",\"groupRoleAttribute\":\"cn\"}"
         }' \
     http://GRAVITEEIO-AM-MGT-API-HOST/management/organizations/DEFAULT/environments/DEFAULT/domains/:domainId/identities
----

== Test connection

You can test your database connection via your web applications created in Gravitee.io AM.

In the Portal UI, navigate to your `Application > Identity Providers` section and select your inline identity provider.

image::am/current/graviteeio-am-userguide-social-idp-list.png[]

To properly test, you should call the Login Page (i.e `/oauth/authorize` endpoint) and try to sign in with the username/password form.

NOTE: If you are not able to authenticate your users, it means that something is invalid with the identity provider settings. Check the Gravitee.io AM gateway log or the audit logs for more information.
